<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hast Rekha</title>
    <link rel="icon" href="./images/logo.svg" type="image/x-icon">
    <!-- link to css -->
    <link rel="stylesheet" href="style.css">
    <!-- link to jbootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <!-- link to jquery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- link to bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- link to popper -->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <!-- link to bootstrap -->
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Axios -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.10.0/axios.min.js"></script>
    <!-- Meta Pixel Code -->
<script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '859889666534410');
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=859889666534410&ev=PageView&noscript=1"
    /></noscript>
    <!-- End Meta Pixel Code -->
</head>
<body>
    <div class="wrapper">
        <div class="container">
            <div class="row">
                <div class="col-12 col-md-12 text-center my-3">
                   <img src="./images/logo.svg" alt="logo" class="logo img-fluid">
                </div>
            </div>
            <div class="row align-items-center">
                <!-- Left Section - Desktop, Full Width - Mobile -->
                <div class="col-12 col-md-6">
                    <h1 class="text-gradient text-center text-md-start">
                        Scan your palm & <br>
                         know your future
                    </h1>
                    <div class="mt-1 d-lg-block d-none">
                        <p class="text-center text-md-start m-0  text-white"
                        style="font-weight: 600;"
                        >
                            Get detailed report for only ₹299/-
                        </p>
                    </div>
                    <div class="mt-1  d-lg-block d-none">
                        <p class="text-center text-md-start text-white fs-16">
                            By country's leading Astrologist!
                        </p>
                    </div>
                    <div class="mt-3 mt-md-4 d-md-block d-none">
                        <button type="button" style="font-size: 18px !important;"
                        class="btn btn-primary-custom uploadPalmBtn justify-content-center d-flex align-items-center " >
                            <img src="./images/camera.svg" alt="upload-icon" class=" me-2">
                            Upload your palm
                        </button>
                        <div class="mt-2">
                            <span class="fs-12 text-white mt-2 d-flex align-items-center justify-content-start">
                                <img src="./images/info.svg" alt="info-icon"
                                style="    width: 15px;margin: 0;"
                                class="me-2">
                                Your data is secure and confidential
                            </span>
                        </div>
                    </div>
                </div>
                <!-- Right Section - Desktop, Full Width - Mobile -->
                <div class="col-12 col-md-6 mt-3 mt-md-0">
                    <img src="./images/scan-hand.svg"
                     alt="scan-hand" class="scan-hand w-100 img-fluid">
                </div>
                <div class=" mt-2 d-lg-none d-block">
                    <p class="text-center text-md-start text-white m-0"
                    style="font-weight: 600;">
                        Get detailed report for only ₹299/-
                    </p>
                </div>
                <div class="mt-1 d-lg-none d-block">
                    <p class="text-center text-md-start text-white m-0 fs-16">
                        By country's leading Astrologist!
                    </p>
                </div>
                
                <!-- Mobile Button Section -->
                <div class="col-12 mt-4 d-md-none">
                    <div class="footer-div">
                        <button type="button" style="font-size: 20px !important;"
                         class="btn btn-primary-custom py-3 w-100 uploadPalmBtn justify-content-center d-flex align-items-center" >
                            <img src="./images/camera.svg" alt="upload-icon" class="me-2">
                            Upload your palm
                        </button>
                        <div class="text-center mt-1">
                            <span class="fs-12 text-white mt-2 d-flex align-items-center justify-content-center">
                                <img src="./images/info.svg" alt="info-icon"
                                style="    width: 15px;margin: 0;"
                                class="me-2">
                                Your data is secure and confidential.
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden form for payment checkout -->
    <form id="bookNowForm" style="display: none;">
        <input type="hidden" name="package-type" id="package-type">
        <input type="hidden" name="success_redirect_url" id="success-redirect-url">
    </form>

    <script>
        $(document).ready(function () {
            // Handle upload palm button click
            $(".uploadPalmBtn").click(function (e) {
                e.preventDefault();
                console.log("Upload palm button clicked");

                // Set package type
                const packageType = 'Hast Rekha';
                $("#package-type").val(packageType);
                
                // Set success redirect URL to upload-palm-form.html
                const baseUrl = window.location.origin;
                const currentPath = window.location.pathname;
                // Get directory path (remove filename from path)
                const directoryPath = currentPath.substring(0, currentPath.lastIndexOf('/'));
                const successRedirectUrl = baseUrl + (directoryPath ? directoryPath : '') + '/upload-palm-form.html';
                $("#success-redirect-url").val(successRedirectUrl);
                
                console.log("Package type:", packageType);
                console.log("Success redirect URL:", successRedirectUrl);

                // Submit the form
                $("#bookNowForm").submit();
            });

            // Handle form submission
            $("#bookNowForm").submit(function (e) {
                e.preventDefault();
                
                // Ensure success_redirect_url is set if not already set
                if (!$("#success-redirect-url").val()) {
                    const baseUrl = window.location.origin;
                    const currentPath = window.location.pathname;
                    const directoryPath = currentPath.substring(0, currentPath.lastIndexOf('/'));
                    const successRedirectUrl = baseUrl + (directoryPath ? directoryPath : '') + '/upload-palm-form.html';
                    $("#success-redirect-url").val(successRedirectUrl);
                }
                
                const formData = $(this).serialize();
                console.log("Form data being sent:", formData);

                // Show loading spinner
                Swal.fire({
                    title: 'Processing your booking...',
                    html: 'Please wait while we process your request.',
                    allowOutsideClick: false,
                    didOpen: () => {
                        Swal.showLoading();
                    }
                });

                // Submit the form using axios request
                axios.post('https://sanatanis.app/mainajaxcalls/main/book', $(this).serialize())
                    .then(function (response) {
                        if (response.data.success_msg) {
                            const responseData = response.data.data;

                            if (responseData && responseData.redirect_url) {
                                // Redirect to the payment page
                                window.location.href = responseData.redirect_url;
                            } else {
                                // Show error message
                                Swal.fire({
                                    icon: 'error',
                                    title: 'Booking Failed',
                                    text: response.data.errors[0] || 'Something went wrong. Please try again later.',
                                    confirmButtonColor: '#FDD513',
                                    confirmButtonText: 'OK'
                                });
                            }
                        } else {
                            Swal.fire({
                                icon: 'error',
                                title: 'Booking Failed',
                                text: response.data.message || 'Something went wrong. Please try again later.',
                                confirmButtonColor: '#FDD513',
                                confirmButtonText: 'OK'
                            });
                        }
                    })
                    .catch(function (error) {
                        console.error('Error:', error);
                        Swal.fire({
                            icon: 'error',
                            title: 'Booking Failed',
                            text: 'An error occurred while processing your request. Please try again later.',
                            confirmButtonColor: '#FDD513',
                            confirmButtonText: 'OK'
                        });
                    });
            });
        });
    </script>
</body>
</html>